<!DOCTYPE html>
<html lang="en">
<!--I don't know what I'm doing, feel free to message me with bugfixes-->
<head>
    <link rel="stylesheet" href="./assets/style.css">
    <link rel="stylesheet" href="./assets/stylep2.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebDesk</title>
    <script>
        var ver = "0.0.9";
        var lastedit = "April 22, 2024";
        var locked = false;
    </script>
</head>

<body>
    <div id="deathcurtain" style="z-index: 9999; position: fixed; left: 0px; top: 0px; bottom: 0px; right: 0px; background-color: #000;"></div>
    <div id="oobespace">
        <div id="setupbg" onmousedown="unlock('setupbg');">
            <div id="sorryapple">
                <svg id="hellosvg" viewBox="0 0 1230.94 414.57">
                    <path
                        d="M-293.58-104.62S-103.61-205.49-60-366.25c9.13-32.45,9-58.31,0-74-10.72-18.82-49.69-33.21-75.55,31.94-27.82,70.11-52.22,377.24-44.11,322.48s34-176.24,99.89-183.19c37.66-4,49.55,23.58,52.83,47.92a117.06,117.06,0,0,1-3,45.32c-7.17,27.28-20.47,97.67,33.51,96.86,66.93-1,131.91-53.89,159.55-84.49,31.1-36.17,31.1-70.64,19.27-90.25-16.74-29.92-69.47-33-92.79,16.73C62.78-179.86,98.7-93.8,159-81.63S302.7-99.55,393.3-269.92c29.86-58.16,52.85-114.71,46.14-150.08-7.44-39.21-59.74-54.5-92.87-8.7-47,65-61.78,266.62-34.74,308.53S416.62-58,481.52-130.31s133.2-188.56,146.54-256.23c14-71.15-56.94-94.64-88.4-47.32C500.53-375,467.58-229.49,503.3-127a73.73,73.73,0,0,0,23.43,33.67c25.49,20.23,55.1,16,77.46,6.32a111.25,111.25,0,0,0,30.44-19.87c37.73-34.23,29-36.71,64.58-127.53C724-284.3,785-298.63,821-259.13a71,71,0,0,1,13.69,22.56c17.68,46,6.81,80-6.81,107.89-12,24.62-34.56,42.72-61.45,47.91-23.06,4.45-48.37-.35-66.48-24.27a78.88,78.88,0,0,1-12.66-25.8c-14.75-51,4.14-88.76,11-101.41,6.18-11.39,37.26-69.61,103.42-42.24,55.71,23.05,100.66-23.31,100.66-23.31"
                        transform="translate(311.08 476.02)"
                        style="fill:none;stroke:#fff;stroke-linecap:round;stroke-miterlimit:10;stroke-width:35px" />
                </svg>
                <p class="med"
                    style="font-size: 15px; margin-top: 8px; color: #fff; margin-top: 8px; animation: fucker 4.3s;">
                    Press to open</p>
            </div>
        </div>
        <div class="setup">
            <div id="setup1">
                <p class="h3">Welcome to WebDesk!</p>
                <button class="b1" onclick="guestmode();">Guest</button><button class="b1"
                    onclick="fesw('setup1', 'setup2');">Let's go!</button>
            </div>
            <div id="setup2" class="hide" style="max-width: 290px;">
                <p class="h3">Encryption</p>
                <p>Being unencrypted is significantly faster, but data isn't secured.</p>
                <p>Encryption keeps your data safe behind a password.</p>
                <button class="b1" onclick="fesw('setup2', 'setup1');">Back</button><button class="b1"
                    onclick="writepb('enc', 'y');fesw('setup2', 'setups');">Encrypt</button><button class="b1"
                    onclick="writepb('enc', 'n');fesw('setup2', 'setupn');">Don't encrypt</button>
            </div>
            <div id="setups" class="hide">
                <p class="h3">Password Setup</p>
                <p>Enter a password to decrypt WebDesk with.</p>
                <p>Don't lose this password, as your data is gone without it.</p>
                <input class="i1" type="password" id="oobep" placeholder="Password here"></input>
                <button class="b1"
                    onclick="const p = document.getElementById('oobep').value; pass = p; fesw('setups', 'setupn');">Set
                    password, next!</button>
            </div>
            <div id="setupn" class="hide">
                <p class="h3">User Setup</p>
                <p>Enter a username to use with WebDesk.</p>
                <input class="i1" id="ooben" placeholder="Username here"></input>
                <button class="b1"
                    onclick="const n = document.getElementById('ooben').value; writef('/user/info/name', n);fesw('setupn', 'setupc');">Set
                    username, next!</button>
            </div>
            <div id="setupc" class="hide">
                <p class="h3">Appearance</p>
                <p>Select an accent color, and a theme.</p>
                <p class="bold">Accent color</p>
                <input type="range" id="rainbowSlider" min="0" max="360" value="0">
                <p class="bold">Theme</p>
                <button class="b1 b2" onclick="appear('l');">Light mode</button>
                <button class="b1 b2" onclick="appear();">Dark mode</button>
                <button class="b1" onclick="fesw('setupc', 'setupl');">Done</button>
            </div>
            <div id="setupl" class="hide">
                <p class="h3">Location Services</p>
                <p>You can optionally enable Location Services, to update the weather in your location, use certain weather info to dynamically adjust WebDesk, and possibly more in the future.</p>
                <p>At the moment, your location is only processed through OpenWeatherMap. This info is not sent or collected by WebDesk.</p>
                <input class="i1" placeholder="Enter your country and city" id="oobeloc"></input>
                <button class="b1" onclick="fesw('setupl', 'setupf');">No thanks</button><button class="b1" onclick="fesw('setupl', 'setupf'); writef('/user/info/city', document.getElementById('oobeloc').value);">Done</button>
            </div>
            <div id="setupf" class="hide">
                <p class="h3">Setup is done!</p>
                <p>Click "Reboot" to finish. Have fun!</p>
                <button class="b1 b2" onclick="setupd();">Reboot</button>
            </div>
            <div id="setupa" class="hide" style="max-width: 240px;">
                <p class="authcont">Enter password to continue.</p>
                <input id="authp" class="i1" type="password" placeholder="Password here"></input>
                <button class="b1" onclick="eprompt();">I forgot</button><button class="b1"
                    onclick="authg();">OK</button>
            </div>
        </div>
    </div>
    <div class="window" id="filem" style="width: 400px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="clapp('filem');"></div>
                <div class="winb yel" onmousedown="mini('filem');"></div>
                <div class="winb gre" onmousedown="max('filem');"></div>
            </div>
            <div class="title">Files</div>
        </div>
        <div class="content">
            <div id="breadcrumbs"></div>
            <div id="directoryContents"></div>
        </div>
    </div>
    <div class="window" id="term" style="width: 280px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="clapp('term');"></div>
                <div class="winb yel" onmousedown="mini('term');"></div>
                <div class="winb gre" onmousedown="max('term');"></div>
            </div>
            <div class="title">Terminal</div>
        </div>
        <div class="content">
            <input class="i1" id="termbox" placeholder="Enter JS code here"></i1>
            <button class="b1" onclick="document.getElementById('termbox').value = '';">Clear</button><button class="b1" onclick="const t = document.getElementById('termbox').value;eval(t);snack('Executed.', 2500);">Execute!</button>
        </div>
    </div>
    <div class="window" id="settings" style="width: 300px;">
        <div class="d tb">
            <div class="tnav">
                <div class="winb red" onmousedown="clapp('settings');"></div>
                <div class="winb yel" onmousedown="mini('settings');"></div>
                <div class="winb gre" onmousedown="max('settings');"></div>
            </div>
            <div class="title">Settings</div>
        </div>
        <div class="content">
            <div id="settmain">
                <button class="b1 b2" onclick="fesw('settmain', 'settapp');">Appearance</button>
                <button class="b1 b2" onclick="fesw('settmain', 'settgen');">General</button>
            </div>
            <div id="settapp" class="hide">
                <p>Appearance</p>
                <button class="b1 b2" onclick="appear('l');">Light</button>
                <button class="b1 b2" onclick="appear();">Dark</button>

                <button class="b1" onclick="fesw('settapp', 'settmain');">Back</button>
            </div>
            <div id="settgen" class="hide">
                <p>General</p>
                <button class="b1 b2" onclick="eprompt();">Erase WebDesk</button>
                <button class="b1" onclick="fesw('settgen', 'settmain');">Back</button>
            </div>
        </div>
    </div>
    <div id="gomenu">
        <p>Hello, <span class="uname"></span>!</p>
        <button class="b1 b2" onclick="about();">About</button>
        <button class="b1 b2" onclick="opapp('filem', 'Files');dfm('/');">Files</button>
        <button class="b1 b2" onclick="opapp('term', 'Terminal');">Terminal</button>
        <button class="b1 b2" onclick="opapp('settings', 'Settings');">Settings</button>
        <button class="b1" onclick="toggle('gomenu');">Close</button>
    </div>
    <div id="taskbar"><button class="b3" onclick="toggle('gomenu');">Go</button><span id="taskbara"></span><button
            class="b3 time" onclick="toggle('controlmenu');">Time</button></div>
</body>
<script src="./assets/lib/peer.js"></script>
<script src="./assets/lib/enc.js"></script>
<script src="./assets/lib/jq.js"></script>
<script src="./assets/code/fs.js"></script>
<script src="./assets/code/core.js"></script>
<script src="./assets/code/init.js"></script>
<script src="./assets/code/send.js"></script>
<script src="./assets/apps/about.js"></script>
<script src="./assets/apps/auth.js"></script>
<script src="./assets/apps/files.js"></script>
<script src="./assets/apps/slider.js"></script>
<script>
    async function boots1() {
        hidef('deathcurtain', 400);
        await initializeDB();
        const silly = await readpb('setupdone');
        const enc = readpb('enc');
        if (silly === "y") {
            if (enc === "y") {
                pw('Enter password to continue.', 'boots2()');
            } else {
                boots2();
            }
        } else {
            eraseall();
            showf('setupbg');
            writef('/user/info/accent', '100, 5, 255');
        }
    }

    async function boots2() {
        dest('oobespace'); writepb('setupdone', 'y');
        const name = await readf('/user/info/name');
        const appear2 = await readf('/user/info/appear');
        const accent = await readf('/user/info/accent');
        if (appear2 === "dark") {
            appear();
        }
        cv('accent', accent);
        masschange('uname', name);
    }

    $(document).ready(boots1);
</script>

</html>